(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[50],{5564:function(t,e,i){},"94d2":function(t,e,i){"use strict";i("5564")},fdd1:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-page",{staticClass:"q-pa-sm"},[i("div",{staticClass:"row q-col-gutter-sm",staticStyle:{margin:"10px 12px !important"}},[i("div",{staticClass:"col-lg-12 col-md-12 col-xs-12 col-sm-12"},[i("q-card",{staticClass:"bg-white text-black "},[i("br"),i("h5",{attrs:{align:"center"}},[t._v(" تیکت   '"+t._s(t.ticket.title)+"' ")]),i("q-separator",{staticClass:"bg-info",staticStyle:{margin:"20px auto",width:"50% !important"}}),i("div",{staticClass:"faqs-inner"},[t.ticket.status?i("div",{staticClass:"q-pa-md q-gutter-sm"},[i("q-btn",{attrs:{rounded:"",color:"primary",label:"سوال جدید"},on:{click:function(e){return t.setQuestionDialog("create")}}})],1):i("q-banner",{staticClass:"col-md-11 col-sm-11 col-xs-11 bg-warning shadow-3",staticStyle:{margin:"50px auto !important"},attrs:{rounded:""},scopedSlots:t._u([{key:"avatar",fn:function(){return[i("q-icon",{attrs:{name:"mdi-alert-box",color:"red"}})]},proxy:!0}])},[i("p",{staticStyle:{"text-align":"center"}},[t._v("این تیکت قبلا توسط شما بسته شده است")])]),t._l(t.ticket.questions,(function(e,s){return i("div",{key:s,staticClass:"faq-item",staticStyle:{margin:"20px 20px"}},[i("div",[i("div",{staticClass:"faq-item-inner"},[i("div",{staticClass:"user-image"},[i("img",{attrs:{src:t.ShowImage(t.ticket.user.image),alt:"user-name"}})]),i("div",{staticClass:"user-text"},[i("h6",{staticStyle:{margin:"11px 0 23px"}},[t._v(t._s(t.ticket.user.username)+"\n                    ("+t._s(t.CheckIsSupporterOrSuperUser()?"کاربر":"شما")+")")]),t.ticket.status?i("div",[i("q-btn",{staticStyle:{float:"left !important"},attrs:{rounded:"",color:"green",label:"ویرایش"},on:{click:function(i){return t.EditQuestions(e.id)}}}),i("q-btn",{staticStyle:{float:"left !important"},attrs:{rounded:"",color:"red",label:"حذف"},on:{click:function(i){return t.DeleteQuestion(e.id)}}})],1):t._e(),i("div",{staticClass:"text",domProps:{innerHTML:t._s(e.text)}}),i("div",{staticClass:"user-footer"},[i("div",{staticClass:"date-content"},[i("div",{staticClass:"date"},[t._v(t._s(e.created_at))])])])])])]),i("div",t._l(t.ShowCurrentAnswer(e),(function(e,s){return i("div",{key:s,staticClass:"faq-answers  shadow-3"},[i("div",{staticClass:"faq-answers-inner"},[i("div",{staticClass:"user-image"},[i("img",{attrs:{src:"http://getdrawings.com/free-icon-bw/support-icons-8.png",alt:"user-name"}})]),i("div",{staticClass:"user-text"},[i("h6",{staticStyle:{margin:"8px 0 23px"}},[t._v("\n                      مسئول پاسخ ("+t._s(t.CheckIsSupporterOrSuperUser()?"شما":"پشتیبانی سایت")+")")]),i("div",{staticClass:"text",domProps:{innerHTML:t._s(e.text)}}),i("div",{staticClass:"user-footer"},[i("div",{staticClass:"date-content"},[i("div",{staticClass:"date"},[t._v(t._s(e.created_at))])])])])])])})),0),i("q-separator",{staticClass:"bg-grey",staticStyle:{margin:"50px auto",width:"80% !important"}})],1)})),i("br")],2),i("div",{staticClass:"q-pa-md q-mt-lg q-gutter-sm"},[i("q-btn",{attrs:{rounded:"",color:"secondary"},on:{click:function(e){return t.$router.back()}}},[t._v("بازگشت")]),t.ticket.status?i("div",{staticStyle:{float:"left !important"}},[i("q-btn",{attrs:{rounded:"",color:"pink"},on:{click:function(e){return t.CloseTicket()}}},[t._v("بستن")]),t._v("\n             \n            "),i("q-btn",{attrs:{rounded:"",color:"red"},on:{click:function(e){return t.DeleteTicket()}}},[t._v("حذف تیکت")])],1):t._e()],1),i("QuestionModal",{attrs:{showDialog:t.showDialog,form:t.form,type:t.type,ticket:t.ticket,question:t.question},on:{"update:showDialog":function(e){t.showDialog=e},"update:show-dialog":function(e){t.showDialog=e}}})],1)],1)])])},o=[],a=(i("4de4"),i("ac1f"),i("5319"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-dialog",{model:{value:t._dialog,callback:function(e){t._dialog=e},expression:"_dialog"}},[i("q-card",{staticStyle:{width:"750px","max-width":"100vw"}},[i("q-card-section",{staticClass:"row items-center q-pa-sm q-mb-sm"},[i("div",{staticClass:"q-ml-sm-sm"},[t._v("پرسش جدید برای تیکت   '"+t._s(t.ticket.title)+"'")]),i("q-space"),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mx-auto",staticStyle:{color:"#888888","margin-right":"15px"},attrs:{icon:"mdi-close",flat:"",round:"",size:"sm"}})],1),i("q-card-section",{staticClass:"items-center"},[i("q-form",{staticClass:"row",on:{submit:t.onSubmit}},[i("div",{staticClass:"col-lg-12 col-xs-12 col-sm-4 col- col-md-4 q-pa-xs q-mb-md"},[i("div",{staticClass:"field-label"},[t._v(" متن سوال "),i("span",{staticClass:"text-red",staticStyle:{"font-size":"18px !important"}},[t._v(" * ")])]),i("q-editor",{attrs:{height:"250px",definitions:{bold:{label:"Bold",icon:null,tip:"My bold tooltip"}}},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),i("q-card-actions",{staticClass:"bg-white text-teal"},[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"انصراف"}}),i("q-btn",{attrs:{flat:"",label:"edit"===t.type?"ویرایش سوال":"ثبت سوال",type:"submit"}})],1)],1)],1)],1)],1)}),n=[],r=(i("d3b7"),i("e6cf"),i("a79d"),{props:["showDialog","form","type","ticket","question"],data:function(){return{text:""}},methods:{onSubmit:function(){var t=this;if("<br>"!==this.text&&""!==this.text){this.form.text=this.text;var e=new FormData;for(var i in this.form)null!=this.form[i]&&e.append(i,this.form[i]);"create"!==this.type&&e.append("question",this.question.id),e.append("ticket",this.ticket.id),e.append("user",this.$store.state.shop.user.id),this.$q.loading.show(),"create"===this.type?this.CreateQuestion(t,e):this.UpdateQuestion(t,e)}else this.showNotif("لطفا متن سوال را وارد کنید")},CreateQuestion:function(t,e){this.$axios.post("https://mras.pythonanywhere.com/api/panel/tickets/questions/",e).then((function(){t.showNotif("سوال مورد نظر با موفقیت ثبت شد","mdi-checkbox-marked-circle-outline ","green"),t._dialog=!1})).finally((function(){t.$q.loading.hide()})).catch((function(e){for(var i in e.response.data){t.showNotif(i+" : "+e.response.data[i][0].replace(".",""));break}}))},UpdateQuestion:function(t,e){this.$axios.put("https://mras.pythonanywhere.com/api/panel/tickets/questions/"+t.question.id+"/",e).then((function(){t.showNotif("سوال مورد نظر با موفقیت ویرایش شد","mdi-checkbox-marked-circle-outline ","green"),t._dialog=!1})).finally((function(){t.$q.loading.hide()})).catch((function(e){for(var i in e.response.data){t.showNotif(i+" : "+e.response.data[i][0].replace(".",""));break}}))},showNotif:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"red";this.$q.notify({message:t,icon:e,color:i,position:"bottom-right",progress:!0})}},watch:{showDialog:function(t){var e;t?this.question&&(this.text=this.question.text):(this.text="",this.question=null!==(e=this.question)&&void 0!==e?e:null)}},computed:{_dialog:{get:function(){return this.showDialog},set:function(t){this.$emit("update:showDialog",t)}}}}),c=r,l=i("2877"),u=i("24e8"),d=i("f09f"),h=i("a370"),p=i("2c91"),f=i("9c40"),m=i("0378"),g=i("d66b"),v=i("4b7e"),q=i("7f67"),k=i("eebe"),w=i.n(k),b=Object(l["a"])(c,a,n,!1,null,null,null),x=b.exports;w()(b,"components",{QDialog:u["a"],QCard:d["a"],QCardSection:h["a"],QSpace:p["a"],QBtn:f["a"],QForm:m["a"],QEditor:g["a"],QCardActions:v["a"]}),w()(b,"directives",{ClosePopup:q["a"]});var y={data:function(){return{form:{},type:"create",showDialog:!1,ticket:{},question:null}},methods:{CheckIsSupporterOrSuperUser:function(){if(this.$store.state.shop.user.is_superuser)return!0;var t=this.$store.state.shop.user.roles;if(t){var e=t.filter((function(t){return"supporter"===t.role.title}));if(e.length>0)return!0}return!1},setQuestionDialog:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"create";this.type=t,"edit"!==t&&this.NullData(),this.form.ticket=parseInt(this.ticket.id),this.form.user=parseInt(this.$store.state.shop.user.id),this.showDialog=!0},ShowCurrentAnswer:function(t){return this.ticket.answers.filter((function(e){return e.question===t.id}))},ShowImage:function(t){return t?t.replace("http://localhost:8000/","https://mras.pythonanywhere.com/"):"https://i.pinimg.com/originals/51/f6/fb/51f6fb256629fc755b8870c801092942.png"},NullData:function(){this.form.text=null,this.question=null},showNotif:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"red";this.$q.notify({message:t,icon:e,color:i,position:"bottom-right",progress:!0})},EditQuestions:function(t){var e=this;this.$q.loading.show(),this.$axios.get("https://mras.pythonanywhere.com/api/panel/tickets/questions/"+t+"/").then((function(t){e.form=t.data,e.question=t.data,e.setQuestionDialog("edit"),e.$q.loading.hide()}))},DeleteQuestion:function(t){var e=this;this.$q.dialog({title:"هشدار",message:"آیا میخواهید سوال مورد نظر حدف شود؟",ok:{push:!0,label:"تایید"},cancel:{push:!0,color:"negative"},persistent:!0}).onOk((function(){e.$axios.delete("https://mras.pythonanywhere.com/api/panel/tickets/questions/"+t).then((function(){e.showNotif("سوال مورد نظر با موفقیت حذف شد","mdi-checkbox-marked-circle-outline","green"),e.GetTicket()})).catch((function(){e.showNotif("مشکلی به وجود آمده است")}))}))},DeleteTicket:function(){var t=this,e=this;this.$q.dialog({title:"هشدار",message:"آیا میخواهید تیکت  ( "+e.ticket.title+" ) حذف شود ؟ ",ok:{push:!0,label:"تایید"},cancel:{push:!0,color:"negative"},persistent:!0}).onOk((function(){t.$q.loading.show(),e.$axios.delete("https://mras.pythonanywhere.com/api/panel/tickets/list/"+e.ticket.id).then((function(){e.$router.push("/panel/tickets"),e.showNotif("تیکت مورد نظر با موفقیت حذف شد","mdi-checkbox-marked-circle-outline","green"),e.$q.loading.hide()})).catch((function(){e.showNotif("مشکلی به وجود آمده است")}))}))},CloseTicket:function(){var t=this,e=this;this.$q.dialog({title:"هشدار",message:"آیا میخواهید تیکت  ( "+e.ticket.title+" ) بسته شود ؟ ",ok:{push:!0,label:"تایید"},cancel:{push:!0,color:"negative"},persistent:!0}).onOk((function(){var i=new FormData;i.append("status",!1),t.$q.loading.show(),e.$axios.put("https://mras.pythonanywhere.com/api/panel/tickets/list/"+e.ticket.id+"/",i).then((function(){e.$router.push("/panel/tickets"),e.showNotif("تیکت مورد نظر با موفقیت بسته شد","mdi-checkbox-marked-circle-outline","green"),e.$q.loading.hide()})).catch((function(){e.showNotif("مشکلی به وجود آمده است")}))}))},GetTicket:function(){var t=this;this.$q.loading.show(),this.$axios.get("https://mras.pythonanywhere.com/api/panel/tickets/list/"+this.$route.params.id).then((function(e){t.ticket=e.data,t.$q.loading.hide()}))}},components:{QuestionModal:x},watch:{showDialog:function(t){t||(this.answer=null,this.question=null),this.form.text&&this.GetTicket(),this.form={}}},mounted:function(){this.GetTicket()}},C=y,_=(i("94d2"),i("9989")),$=i("eb85"),S=i("54e1"),Q=i("0016"),D=i("66e5"),N=Object(l["a"])(C,s,o,!1,null,null,null);e["default"]=N.exports;w()(N,"components",{QPage:_["a"],QCard:d["a"],QSeparator:$["a"],QBtn:f["a"],QBanner:S["a"],QIcon:Q["a"],QItem:D["a"]})}}]);